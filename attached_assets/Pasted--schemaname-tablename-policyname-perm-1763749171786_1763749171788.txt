| schemaname | tablename                | policyname                                          | permissive | roles           | USING Clause                                                                                                                                                                                                                                                  | WITH CHECK Clause                                                                                                                                                                            |
| ---------- | ------------------------ | --------------------------------------------------- | ---------- | --------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| public     | admin_users              | Only superadmin can delete admin users              | PERMISSIVE | {public}        | ((role = 'superadmin'::text) AND is_active)                                                                                                                                                                                                                   | null                                                                                                                                                                                         |
| public     | admin_users              | Only superadmin can edit admin users                | PERMISSIVE | {public}        | ((role = 'superadmin'::text) AND is_active)                                                                                                                                                                                                                   | null                                                                                                                                                                                         |
| public     | admin_users              | Superadmin can create admin users                   | PERMISSIVE | {public}        | null                                                                                                                                                                                                                                                          | (EXISTS ( SELECT 1
   FROM admin_users admin_users_1
  WHERE ((admin_users_1.id = auth.uid()) AND (admin_users_1.role = 'superadmin'::text) AND admin_users_1.is_active)))                   |
| public     | admin_users              | Superadmins can insert admin users                  | PERMISSIVE | {authenticated} | null                                                                                                                                                                                                                                                          | (EXISTS ( SELECT 1
   FROM admin_users admin_users_1
  WHERE ((admin_users_1.id = auth.uid()) AND (admin_users_1.role = 'superadmin'::text) AND (admin_users_1.is_active = true))))          |
| public     | admin_users              | Users can view their own admin record               | PERMISSIVE | {authenticated} | (id = auth.uid())                                                                                                                                                                                                                                             | null                                                                                                                                                                                         |
| public     | ai_recommendations       | User can delete own AI recommendations              | PERMISSIVE | {public}        | (user_id = auth.uid())                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | ai_recommendations       | User can insert own AI recommendations              | PERMISSIVE | {public}        | null                                                                                                                                                                                                                                                          | (user_id = auth.uid())                                                                                                                                                                       |
| public     | ai_recommendations       | User can update own AI recommendations              | PERMISSIVE | {public}        | (user_id = auth.uid())                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | ai_recommendations       | User can view own AI recommendations                | PERMISSIVE | {public}        | (user_id = auth.uid())                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | ai_usage_stats           | ai_usage_stats_admin_policy                         | PERMISSIVE | {public}        | (EXISTS ( SELECT 1
   FROM admin_users
  WHERE ((admin_users.id = auth.uid()) AND (admin_users.is_active = true))))                                                                                                                                           | null                                                                                                                                                                                         |
| public     | ai_usage_stats           | ai_usage_stats_user_policy                          | PERMISSIVE | {public}        | (auth.uid() = user_id)                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | analytics_sessions       | users_delete_own_sessions                           | PERMISSIVE | {authenticated} | (user_id = ( SELECT auth.uid() AS uid))                                                                                                                                                                                                                       | null                                                                                                                                                                                         |
| public     | analytics_sessions       | users_insert_own_sessions                           | PERMISSIVE | {authenticated} | null                                                                                                                                                                                                                                                          | (user_id = ( SELECT auth.uid() AS uid))                                                                                                                                                      |
| public     | analytics_sessions       | users_select_own_sessions                           | PERMISSIVE | {authenticated} | (user_id = ( SELECT auth.uid() AS uid))                                                                                                                                                                                                                       | null                                                                                                                                                                                         |
| public     | analytics_sessions       | users_update_own_sessions                           | PERMISSIVE | {authenticated} | (user_id = ( SELECT auth.uid() AS uid))                                                                                                                                                                                                                       | (user_id = ( SELECT auth.uid() AS uid))                                                                                                                                                      |
| public     | app_settings             | Active admin can update app settings                | PERMISSIVE | {public}        | (EXISTS ( SELECT 1
   FROM admin_users
  WHERE ((admin_users.id = auth.uid()) AND admin_users.is_active)))                                                                                                                                                    | null                                                                                                                                                                                         |
| public     | app_settings             | Active admin can view app settings                  | PERMISSIVE | {public}        | (EXISTS ( SELECT 1
   FROM admin_users
  WHERE ((admin_users.id = auth.uid()) AND admin_users.is_active)))                                                                                                                                                    | null                                                                                                                                                                                         |
| public     | chat_conversations       | chat_conversations_admin_policy                     | PERMISSIVE | {public}        | (EXISTS ( SELECT 1
   FROM admin_users
  WHERE ((admin_users.id = auth.uid()) AND (admin_users.is_active = true))))                                                                                                                                           | null                                                                                                                                                                                         |
| public     | chat_conversations       | chat_conversations_user_policy                      | PERMISSIVE | {public}        | (auth.uid() = user_id)                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | chat_messages            | chat_messages_admin_policy                          | PERMISSIVE | {public}        | (EXISTS ( SELECT 1
   FROM admin_users
  WHERE ((admin_users.id = auth.uid()) AND (admin_users.is_active = true))))                                                                                                                                           | null                                                                                                                                                                                         |
| public     | chat_messages            | chat_messages_user_policy                           | PERMISSIVE | {public}        | (EXISTS ( SELECT 1
   FROM chat_conversations
  WHERE ((chat_conversations.id = chat_messages.conversation_id) AND (chat_conversations.user_id = auth.uid()))))                                                                                               | null                                                                                                                                                                                         |
| public     | content_approvals        | Editor can create                                   | PERMISSIVE | {authenticated} | null                                                                                                                                                                                                                                                          | (EXISTS ( SELECT 1
   FROM admin_users
  WHERE ((admin_users.id = auth.uid()) AND (admin_users.role = ANY (ARRAY['editor'::text, 'superadmin'::text])) AND (admin_users.is_active = true)))) |
| public     | content_approvals        | Editor can read all                                 | PERMISSIVE | {authenticated} | (EXISTS ( SELECT 1
   FROM admin_users
  WHERE ((admin_users.id = auth.uid()) AND (admin_users.role = ANY (ARRAY['editor'::text, 'moderator'::text, 'superadmin'::text])) AND (admin_users.is_active = true))))                                               | null                                                                                                                                                                                         |
| public     | content_approvals        | Editor can update own pending                       | PERMISSIVE | {authenticated} | ((submitted_by = auth.uid()) AND (status = 'pending'::text) AND (EXISTS ( SELECT 1
   FROM admin_users
  WHERE ((admin_users.id = auth.uid()) AND (admin_users.role = ANY (ARRAY['editor'::text, 'superadmin'::text])) AND (admin_users.is_active = true))))) | null                                                                                                                                                                                         |
| public     | content_approvals        | Superadmin full access                              | PERMISSIVE | {authenticated} | (EXISTS ( SELECT 1
   FROM admin_users
  WHERE ((admin_users.id = auth.uid()) AND (admin_users.role = 'superadmin'::text) AND (admin_users.is_active = true))))                                                                                               | null                                                                                                                                                                                         |
| public     | dashboard_hero           | Admins can insert/update/delete dashboard hero      | PERMISSIVE | {public}        | (EXISTS ( SELECT 1
   FROM admin_users
  WHERE ((admin_users.id = auth.uid()) AND admin_users.is_active)))                                                                                                                                                    | null                                                                                                                                                                                         |
| public     | dashboard_hero           | Any user can view dashboard hero                    | PERMISSIVE | {public}        | true                                                                                                                                                                                                                                                          | null                                                                                                                                                                                         |
| public     | learning_completions     | Editors can view learning_completions               | PERMISSIVE | {public}        | (EXISTS ( SELECT 1
   FROM admin_users
  WHERE ((admin_users.id = auth.uid()) AND (admin_users.role = 'editor'::text) AND (admin_users.is_active = true))))                                                                                                   | null                                                                                                                                                                                         |
| public     | learning_completions     | Moderators can view learning_completions            | PERMISSIVE | {public}        | (EXISTS ( SELECT 1
   FROM admin_users
  WHERE ((admin_users.id = auth.uid()) AND (admin_users.role = 'moderator'::text) AND (admin_users.is_active = true))))                                                                                                | null                                                                                                                                                                                         |
| public     | learning_completions     | Superadmins can view all learning_completions       | PERMISSIVE | {public}        | (EXISTS ( SELECT 1
   FROM admin_users
  WHERE ((admin_users.id = auth.uid()) AND (admin_users.role = 'superadmin'::text) AND (admin_users.is_active = true))))                                                                                               | null                                                                                                                                                                                         |
| public     | learning_completions     | Users can insert their own completions              | PERMISSIVE | {public}        | null                                                                                                                                                                                                                                                          | (user_id = auth.uid())                                                                                                                                                                       |
| public     | learning_completions     | Users can update their own completions              | PERMISSIVE | {public}        | (user_id = auth.uid())                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | learning_completions     | Users can view their own completions                | PERMISSIVE | {public}        | (user_id = auth.uid())                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | learning_paths           | User can delete own learning path                   | PERMISSIVE | {public}        | (user_id = auth.uid())                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | learning_paths           | User can insert own learning path                   | PERMISSIVE | {public}        | null                                                                                                                                                                                                                                                          | (user_id = auth.uid())                                                                                                                                                                       |
| public     | learning_paths           | User can update own learning path                   | PERMISSIVE | {public}        | (user_id = auth.uid())                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | learning_paths           | User can view own learning path                     | PERMISSIVE | {public}        | (user_id = auth.uid())                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | lesson_quiz_results      | Admins can view all quiz results                    | PERMISSIVE | {public}        | (EXISTS ( SELECT 1
   FROM admin_users
  WHERE ((admin_users.id = auth.uid()) AND (admin_users.is_active = true))))                                                                                                                                           | null                                                                                                                                                                                         |
| public     | lesson_quiz_results      | Users can insert own quiz results                   | PERMISSIVE | {public}        | null                                                                                                                                                                                                                                                          | (auth.uid() = user_id)                                                                                                                                                                       |
| public     | lesson_quiz_results      | Users can view own quiz results                     | PERMISSIVE | {public}        | (auth.uid() = user_id)                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | lessons                  | Public read access for lessons                      | PERMISSIVE | {public}        | (is_active = true)                                                                                                                                                                                                                                            | null                                                                                                                                                                                         |
| public     | mock_exam_config         | Admins can manage mock exam config                  | PERMISSIVE | {public}        | (EXISTS ( SELECT 1
   FROM admin_users
  WHERE ((admin_users.id = auth.uid()) AND (admin_users.is_active = true))))                                                                                                                                           | null                                                                                                                                                                                         |
| public     | mock_exam_config         | Students can view mock exam config                  | PERMISSIVE | {public}        | true                                                                                                                                                                                                                                                          | null                                                                                                                                                                                         |
| public     | mock_exams               | User can insert own mock exam                       | PERMISSIVE | {public}        | null                                                                                                                                                                                                                                                          | (user_id = auth.uid())                                                                                                                                                                       |
| public     | mock_exams               | User can manage own mock exams                      | PERMISSIVE | {public}        | (user_id = auth.uid())                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | mock_results             | User can insert result for own mock exam            | PERMISSIVE | {public}        | null                                                                                                                                                                                                                                                          | (mock_exam_id IN ( SELECT mock_exams.id
   FROM mock_exams
  WHERE (mock_exams.user_id = auth.uid())))                                                                                       |
| public     | mock_results             | User can view results of own mock exam              | PERMISSIVE | {public}        | (mock_exam_id IN ( SELECT mock_exams.id
   FROM mock_exams
  WHERE (mock_exams.user_id = auth.uid())))                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | mock_sessions            | Users can insert own mock sessions                  | PERMISSIVE | {public}        | null                                                                                                                                                                                                                                                          | (auth.uid() = user_id)                                                                                                                                                                       |
| public     | mock_sessions            | Users can update own mock sessions                  | PERMISSIVE | {public}        | (auth.uid() = user_id)                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | mock_sessions            | Users can view own mock sessions                    | PERMISSIVE | {public}        | (auth.uid() = user_id)                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | modules                  | Public read access for modules                      | PERMISSIVE | {public}        | (is_active = true)                                                                                                                                                                                                                                            | null                                                                                                                                                                                         |
| public     | notification_preferences | Service role can manage all preferences             | PERMISSIVE | {service_role}  | true                                                                                                                                                                                                                                                          | true                                                                                                                                                                                         |
| public     | notification_preferences | Users can insert their own notification preferences | PERMISSIVE | {public}        | null                                                                                                                                                                                                                                                          | (auth.uid() = user_id)                                                                                                                                                                       |
| public     | notification_preferences | Users can read their own notification preferences   | PERMISSIVE | {public}        | (auth.uid() = user_id)                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | notification_preferences | Users can update their own notification preferences | PERMISSIVE | {public}        | (auth.uid() = user_id)                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | notification_preferences | Users can update their own preferences              | PERMISSIVE | {authenticated} | (auth.uid() = user_id)                                                                                                                                                                                                                                        | (auth.uid() = user_id)                                                                                                                                                                       |
| public     | notification_preferences | Users can view their own preferences                | PERMISSIVE | {authenticated} | (auth.uid() = user_id)                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | notification_queue       | Admins can view notification queue                  | PERMISSIVE | {authenticated} | (EXISTS ( SELECT 1
   FROM admin_users
  WHERE ((admin_users.id = auth.uid()) AND (admin_users.is_active = true))))                                                                                                                                           | null                                                                                                                                                                                         |
| public     | notification_queue       | Service role can manage notification queue          | PERMISSIVE | {service_role}  | true                                                                                                                                                                                                                                                          | true                                                                                                                                                                                         |
| public     | notification_targets     | Admins can view all notification targets            | PERMISSIVE | {authenticated} | (EXISTS ( SELECT 1
   FROM admin_users
  WHERE ((admin_users.id = auth.uid()) AND (admin_users.is_active = true))))                                                                                                                                           | null                                                                                                                                                                                         |
| public     | notification_targets     | Service role can manage notification targets        | PERMISSIVE | {service_role}  | true                                                                                                                                                                                                                                                          | true                                                                                                                                                                                         |
| public     | notification_targets     | Users can view own notification targets             | PERMISSIVE | {authenticated} | (user_id = auth.uid())                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | notifications            | Admins can create notifications                     | PERMISSIVE | {authenticated} | null                                                                                                                                                                                                                                                          | (EXISTS ( SELECT 1
   FROM admin_users
  WHERE ((admin_users.id = auth.uid()) AND (admin_users.is_active = true) AND (admin_users.role = ANY (ARRAY['superadmin'::text, 'editor'::text]))))) |
| public     | notifications            | Admins can delete notifications                     | PERMISSIVE | {authenticated} | (EXISTS ( SELECT 1
   FROM admin_users
  WHERE ((admin_users.id = auth.uid()) AND (admin_users.is_active = true) AND (admin_users.role = 'superadmin'::text))))                                                                                               | null                                                                                                                                                                                         |
| public     | notifications            | Admins can update notifications                     | PERMISSIVE | {authenticated} | (EXISTS ( SELECT 1
   FROM admin_users
  WHERE ((admin_users.id = auth.uid()) AND (admin_users.is_active = true) AND (admin_users.role = ANY (ARRAY['superadmin'::text, 'editor'::text])))))                                                                  | null                                                                                                                                                                                         |
| public     | notifications            | Admins can view all notifications                   | PERMISSIVE | {authenticated} | (EXISTS ( SELECT 1
   FROM admin_users
  WHERE ((admin_users.id = auth.uid()) AND (admin_users.is_active = true))))                                                                                                                                           | null                                                                                                                                                                                         |
| public     | notifications            | Service role can manage notifications               | PERMISSIVE | {service_role}  | true                                                                                                                                                                                                                                                          | true                                                                                                                                                                                         |
| public     | notifications            | Users can view all notifications                    | PERMISSIVE | {authenticated} | true                                                                                                                                                                                                                                                          | null                                                                                                                                                                                         |
| public     | practice_results         | User can insert result for own practice session     | PERMISSIVE | {public}        | null                                                                                                                                                                                                                                                          | (session_id IN ( SELECT practice_sessions.id
   FROM practice_sessions
  WHERE (practice_sessions.user_id = auth.uid())))                                                                    |
| public     | practice_results         | User can view results of own practice session       | PERMISSIVE | {public}        | (session_id IN ( SELECT practice_sessions.id
   FROM practice_sessions
  WHERE (practice_sessions.user_id = auth.uid())))                                                                                                                                     | null                                                                                                                                                                                         |
| public     | practice_sessions        | User can insert own practice session                | PERMISSIVE | {public}        | null                                                                                                                                                                                                                                                          | (user_id = auth.uid())                                                                                                                                                                       |
| public     | practice_sessions        | User can manage own practice sessions               | PERMISSIVE | {public}        | (user_id = auth.uid())                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | practice_sessions        | User can update own practice session                | PERMISSIVE | {public}        | (user_id = auth.uid())                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | push_tokens              | Admins can view all push tokens                     | PERMISSIVE | {authenticated} | (EXISTS ( SELECT 1
   FROM admin_users
  WHERE ((admin_users.id = auth.uid()) AND (admin_users.is_active = true))))                                                                                                                                           | null                                                                                                                                                                                         |
| public     | push_tokens              | Users can delete own push tokens                    | PERMISSIVE | {authenticated} | (user_id = auth.uid())                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | push_tokens              | Users can insert own push tokens                    | PERMISSIVE | {authenticated} | null                                                                                                                                                                                                                                                          | (user_id = auth.uid())                                                                                                                                                                       |
| public     | push_tokens              | Users can update own push tokens                    | PERMISSIVE | {authenticated} | (user_id = auth.uid())                                                                                                                                                                                                                                        | (user_id = auth.uid())                                                                                                                                                                       |
| public     | push_tokens              | Users can view own push tokens                      | PERMISSIVE | {authenticated} | (user_id = auth.uid())                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | question_media           | Anyone can view question media                      | PERMISSIVE | {public}        | true                                                                                                                                                                                                                                                          | null                                                                                                                                                                                         |
| public     | subscriptions            | Superadmins can view all subscriptions              | PERMISSIVE | {authenticated} | (EXISTS ( SELECT 1
   FROM admin_users
  WHERE ((admin_users.id = auth.uid()) AND (admin_users.role = 'superadmin'::text) AND (admin_users.is_active = true))))                                                                                               | null                                                                                                                                                                                         |
| public     | subscriptions            | User can view own subscription                      | PERMISSIVE | {public}        | (user_id = auth.uid())                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | subtopics                | Anyone can view subtopics                           | PERMISSIVE | {public}        | true                                                                                                                                                                                                                                                          | null                                                                                                                                                                                         |
| public     | topics                   | Public read access for topics                       | PERMISSIVE | {public}        | (is_active = true)                                                                                                                                                                                                                                            | null                                                                                                                                                                                         |
| public     | user_analytics           | User can insert own analytics                       | PERMISSIVE | {public}        | null                                                                                                                                                                                                                                                          | (user_id = auth.uid())                                                                                                                                                                       |
| public     | user_analytics           | User can update own analytics                       | PERMISSIVE | {public}        | (user_id = auth.uid())                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | user_analytics           | User can view own analytics                         | PERMISSIVE | {public}        | (user_id = auth.uid())                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | user_notification_reads  | Users can delete their own notification reads       | PERMISSIVE | {public}        | (auth.uid() = user_id)                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | user_notification_reads  | Users can delete their own read records             | PERMISSIVE | {authenticated} | (auth.uid() = user_id)                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | user_notification_reads  | Users can mark notifications as read                | PERMISSIVE | {public}        | null                                                                                                                                                                                                                                                          | (auth.uid() = user_id)                                                                                                                                                                       |
| public     | user_notification_reads  | Users can read their own notification reads         | PERMISSIVE | {public}        | (auth.uid() = user_id)                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | user_notification_reads  | Users can view their own read notifications         | PERMISSIVE | {authenticated} | (auth.uid() = user_id)                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | user_profiles            | User can delete own profile                         | PERMISSIVE | {public}        | (user_id = auth.uid())                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | user_profiles            | User can insert own profile                         | PERMISSIVE | {public}        | null                                                                                                                                                                                                                                                          | (user_id = auth.uid())                                                                                                                                                                       |
| public     | user_profiles            | User can update own profile                         | PERMISSIVE | {public}        | (user_id = auth.uid())                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | user_profiles            | User can view own profile                           | PERMISSIVE | {public}        | (user_id = auth.uid())                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | user_profiles            | Users can insert their own profile                  | PERMISSIVE | {public}        | null                                                                                                                                                                                                                                                          | (auth.uid() = user_id)                                                                                                                                                                       |
| public     | user_profiles            | Users can update their own profile                  | PERMISSIVE | {public}        | (auth.uid() = user_id)                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | user_profiles            | Users can view their own profile                    | PERMISSIVE | {public}        | (auth.uid() = user_id)                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |
| public     | user_sessions            | Service role can manage all sessions                | PERMISSIVE | {service_role}  | true                                                                                                                                                                                                                                                          | true                                                                                                                                                                                         |
| public     | user_sessions            | User can update own sessions                        | PERMISSIVE | {public}        | (user_id = auth.uid())                                                                                                                                                                                                                                        | null                                                                                                                                                                                         |